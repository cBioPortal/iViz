<!doctype html>
<html class="no-js" lang="">
<head>
  <meta charset="utf-8">

  <!-- This file shouldn't be included in cBioPortal -->
  <!-- build:js(.) scripts/iviz-vendor-cbio.js -->
  <script src="/bower_components/jquery/jquery.min.js"></script>
  <script src="/bower_components/jquery-ui/ui/jquery-ui.js"></script>
  <!-- endbuild -->

  <!-- build:js(.) scripts/iviz-vendor.js -->
  <script src="/bower_components/modernizr/modernizr.js"></script>
  <script src="/bower_components/chosen/chosen.jquery.min.js"></script>
  <script src="/bower_components/datatables/media/js/jquery.dataTables.js"></script>
  <script src="/bower_components/d3/d3.min.js"></script>
  <script src="/bower_components/crossfilter2/crossfilter.min.js"></script>
  <script src="/bower_components/dcjs/dc.js"></script>
  <script src="/bower_components/classie/classie.js"></script>
  <script src="/bower_components/get-style-property/get-style-property.js"></script>
  <script src="/bower_components/get-size/get-size.js"></script>
  <script src="/bower_components/eventie/eventie.js"></script>
  <script src="/bower_components/eventEmitter/EventEmitter.js"></script>
  <script src="/bower_components/unipointer/unipointer.js"></script>
  <script src="/bower_components/unidragger/unidragger.js"></script>
  <script src="/bower_components/draggabilly/draggabilly.js"></script>
  <script src="/bower_components/doc-ready/doc-ready.js"></script>
  <script src="/bower_components/matches-selector/matches-selector.js"></script>
  <script src="/bower_components/fizzy-ui-utils/utils.js"></script>
  <script src="/bower_components/outlayer/item.js"></script>
  <script src="/bower_components/outlayer/outlayer.js"></script>
  <script src="/bower_components/packery/dist/packery.pkgd.js"></script>
  <script src="/bower_components/underscore/underscore.js"></script>
  <script src="/bower_components/ev-emitter/ev-emitter.js"></script>
  <script src="/bower_components/imagesloaded/imagesloaded.js"></script>
  <script src="/bower_components/qtip2/jquery.qtip.js"></script>
  <script src="/bower_components/qtip2/basic/jquery.qtip.js"></script>
  <script src="/bower_components/vue/dist/vue.js"></script>
  <script src="/bower_components/clipboard/dist/clipboard.js"></script>
  <script src="/bower_components/plotly.js/dist/plotly.min.js"></script>
  <script src="/bower_components/react/react.js"></script>
  <script src="/bower_components/react/react-dom.js"></script>
  <script src="/bower_components/fixed-data-table/dist/fixed-data-table.min.js"></script>
  <script src="/bower_components/jstat/dist/jstat.min.js"></script>
  <script src="/bower_components/backbone/backbone.js"></script>
  <script src="/bower_components/remarkable-bootstrap-notify/bootstrap-notify.js"></script>
  <!-- endbuild -->

  <!-- build:css(.) styles/iviz-vendor.css -->
  <link rel="stylesheet" href="/.tmp/styles/vendor.css"/>
  <!-- bower:css -->
  <link rel="stylesheet" href="/bower_components/datatables/media/css/jquery.dataTables.css" />
  <link rel="stylesheet" href="/bower_components/dcjs/dc.css" />
  <link rel="stylesheet" href="/bower_components/qtip2/jquery.qtip.css" />
  <link rel="stylesheet" href="/bower_components/fixed-data-table/dist/fixed-data-table.min.css" />
  <!-- endbower -->
  <!-- endbuild -->

  <!-- build:css(.tmp) styles/vc-session.css -->
  <link rel="stylesheet" href="styles/vendor/vc-session.css"/>
  <!-- endbuild -->

  <!-- build:css(.tmp) styles/iviz.css -->
  <link rel="stylesheet" href="styles/main.css"/>
  <!-- endbuild -->

  <!-- build:js scripts/cbio-vendor.js -->
  <script src="_components/FileSaver.min.js"></script>
  <script src="_components/cbio-util.js"></script>
  <script src="_components/download-util.js"></script>
  <script src="_components/Notification.js"></script>
  <script src="_components/GeneValidator.js"></script>
  <script src="_components/QueryByGeneUtil.js"></script>
  <script src="_components/QueryByGeneTextArea.js"></script>
  <script src="_components/MutatedGeneCNATable.js"></script>
  <!-- endbuild -->

  <!-- build:js scripts/vc-session.js -->
  <script src="_components/vc-session.js"></script>
  <!-- endbuild -->

  <!-- build:js scripts/iviz.js -->
  <script src="scripts/main.js"></script>
  <script src="scripts/vueCore.js"></script>
  <script src="scripts/controller/util.js"></script>
  <script src="scripts/views/mainTemplate.js"></script>
  <script src="scripts/views/chartGroupTemplate.js"></script>
  <script src="scripts/views/individualChartTemplate.js"></script>
  <script src="scripts/views/components/generalChart.js"></script>
  <script src="scripts/views/components/chartOperationsHeader.js"></script>
  <script src="scripts/views/components/header/manageCharts.js"></script>
  <script src="scripts/views/components/header/breadCrumbTemplate.js"></script>
  <script src="scripts/views/components/pieChart/pieChart.js"></script>
  <script src="scripts/views/components/pieChart/pieChartTemplate.js"></script>
  <script src="scripts/views/components/barChart/barChart.js"></script>
  <script src="scripts/views/components/barChart/barChartTemplate.js"></script>
  <script src="scripts/views/components/scatterPlot/scatterPlot.js"></script>
  <script src="scripts/views/components/scatterPlot/scatterPlotTemplate.js"></script>
  <script src="scripts/views/components/survivalChart/main.js"></script>
  <script src="scripts/views/components/survivalChart/template.js"></script>
  <script src="scripts/views/components/survivalChart/components/kmEstimator.js"></script>
  <script src="scripts/views/components/survivalChart/components/logRankTest.js"></script>
  <script src="scripts/views/components/survivalChart/components/curve.js"></script>
  <script src="scripts/views/components/survivalChart/proxy.js"></script>
  <script src="scripts/views/components/dataTable/tableView.js"></script>
  <script src="scripts/views/components/dataTable/tableViewTemplate.js"></script>
  <script src="scripts/views/components/customPlots/CaseDialogBox.js"></script>
  <!-- endbuild -->

  <script src="scripts/model/dataProxy.js"></script>
  <script src="_components/cbioportal-client.js"></script>

</head>
<body>

<div class="container-fluid" id="complete-screen">
  <div id="complete-screen-loader" 
       :class="{'show-loading': showScreenLoad}" 
       class="chart-loader" style="top: 30%; left: 30%; display: none;"><img
    src="images/ajax-loader.gif" alt="loading"></div>
  <nav class="navbar navbar-default navbar-fixed-top">
    <div id="main-header" style="display: none" :class="{show:!isloading}">
      <div id="iviz-header-left">
        <div class="iviz-cohort-component" style="float: left; margin-right: 10px;">
          <session-component :show-save-button="showSaveButton" :show-manage-button="showManageButton"
                             :selected-patients-num="selectedPatientsNum" :selected-samples-num="selectedSamplesNum"
                             :userid="userid" :stats="stats" :update-stats.sync="updateStats"></session-component>
        </div>

        <div class="iviz-header-left-case">
          <span class="name" style="display: block;">Selected:</span>
          <span class="content">
            <span>{{ selectedSamplesNum }} samples / {{ selectedPatientsNum }} patients</span>
          </span>
        </div>
        <span id="iviz-header-left-patient-select" class="iviz-header-button"
              @click="openCases('patient')" class="number"
              role="button" tabindex="0" style="display: block;"><i class="fa fa-user" aria-hidden="true"></i></span>
        <span id="iviz-header-left-case-download" class="iviz-header-button" @click="downloadCaseData()" 
              role="button" 
              tabindex="0"><i class="fa fa-download" alt="download"></i></span>
      
      <span id="query-by-gene-span">
          <textarea id="query-by-gene-textarea" class="expand expandFocusOut" rows="1" cols="10"></textarea>
      </span>
        <span class="iviz-header-arrow">
          <i  class="fa fa-arrow-right fa-lg" aria-hidden="true"></i>
        </span>
        <form id="iviz-form"  v-on:submit.prevent="submitForm" method="post" target="_blank" style="float: left;">
          <input type="submit" id="iviz-header-left-1" value="Query" class="iviz-header-button" style="display: block;">
        </form>
      
      </div>
      
      <div id="iviz-header-right">
        <custom-case-input></custom-case-input>
        
        <select id="iviz-add-chart" class="chosen-select"
                v-select :charts="charts" v-if="showDropDown">
          <option id='' value="">Add Chart</option>
          <option id="{{data.attr_id}}" v-if="!data.show" value="{{data.attr_id}}" v-for="(index,data) in charts">{{data.display_name}}</option>
        </select>
      </div>

      <div id="breadcrumbs_container" v-if="hasfilters">
        <div style="float:left;" >
          <span class="breadcrumb_container">Your selections: </span>
        </div>

        <span class="breadcrumb_container" v-if="customfilter.patientIds.length>0||customfilter.sampleIds.length>0">
          <span>{{customfilter.display_name}}</span>
          <i class="fa fa-times breadcrumb_remove" 
             @click="clearAllCharts(true)"></i>
        </span>
        <div style="float:left" v-for="group in groups">
          <bread-crumb :attributes.sync="item"
                       :filters.sync="item.filter" v-for="(index1, item) in group.attributes"
                       v-if="item.filter.length>0" ></bread-crumb>
        </div>
        <div style="float:left"><button type='button' @click="clearAllCharts(true)" 
                     class="btn btn-default btn-xs">Clear All</button></div>
      </div>
    </div>
  </nav>
  <div :class="{'start-loading': showScreenLoad}">
  <div class="grid" id="main-grid" 
       :class="{loading:isloading}">
    <main-template :groups.sync="groups" :redrawgroups.sync="redrawgroups"
                   :selectedpatients.sync="selectedpatients"
                   :selectedsamples.sync="selectedsamples"
                   :hasfilters.sync="hasfilters" 
                   :customfilter.sync="customfilter" 
                   :clear-all="clearAll"></main-template>
  </div>
  </div>

</div>

</body>
<script>
  $(document).ready(function() {
    //Include style variables
    window.style = {
      vars: {}
    };
    iViz.vue.manage.init();

    // This is used to indicate how to disable two buttons. By default, they are set to true.
    iViz.vue.manage.getInstance().showManageButton = true;
    iViz.vue.manage.getInstance().showSaveButton = true;

    $.getJSON('resources/vars.json')
      .then(function(data) {
        window.style.vars.width = {
          one: iViz.util.pxStringToNumber(data['grid-w-1']) || 195,
          two: iViz.util.pxStringToNumber(data['grid-w-2']) || 400
        };
        window.style.vars.height = {
          one: iViz.util.pxStringToNumber(data['grid-h-1']) || 170,
          two: iViz.util.pxStringToNumber(data['grid-h-2']) || 350
        };
        window.style.vars.chartHeader = 17;
        window.style.vars.borderWidth = 2;
        Window
        window.style.vars.scatter = {
          width: (window.style.vars.width.two - window.style.vars.borderWidth) || 400,
          height: (window.style.vars.height.two - window.style.vars.chartHeader
          - window.style.vars.borderWidth) || 350
        };
        window.style.vars.survival = {
          width: window.style.vars.scatter.width,
          height: window.style.vars.scatter.height
        };
        window.style.vars.specialTables = {
          width: window.style.vars.scatter.width,
          height: window.style.vars.scatter.height - 25
        };
        window.style.vars.piechart = {
          width: 140,
          height: 140
        };
        window.style.vars.barchart = {
          width: (window.style.vars.width.two - window.style.vars.borderWidth) || 400,
          height: (window.style.vars.height.one - window.style.vars.chartHeader * 2
          - window.style.vars.borderWidth) || 130
        };
      })
      .fail(function() {
        window.style.vars = {
          width: {
            one: 195,
            two: 400
          },
          height: {
            one: 170,
            two: 350
          },
          chartHeader: 15,
          borderWidth: 2,
          scatter: {
            width: 400,
            height: 350
          },
          survival: {
            width: 400,
            height: 350
          },
          specialTables: {
            width: 400,
            height:350
          },
          piechart: {
            width: 180,
            height: 140
          },
          barchart: {
            width: 400,
            height: 30
          }
        }
      });
    window.cbioURL = 'http://www.cbioportal.org/';
    window.mutationProfileId ='hnsc_tcga_mutations';
    window.cnaProfileId = 'hnsc_tcga_gistic';
    window.case_set_id = '-1';
    var studyCasesMap = {};
    studyCasesMap['hnsc_tcga']={};
    window.iviz = {};
    window.iviz.datamanager = new DataManagerForIviz.init(window.cbioURL, studyCasesMap);
    $.when(window.iviz.datamanager.initialSetup()).then(function(_data) {
      iViz.init(_data);
    });

    QueryByGeneTextArea.init('#query-by-gene-textarea', function(genes) {
      iViz.vue.manage.getInstance().$broadcast('gene-list-updated', genes);
    });

  });
</script>
</html>
